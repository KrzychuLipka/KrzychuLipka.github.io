"use strict";(self.webpackChunkgeo_desc_test=self.webpackChunkgeo_desc_test||[]).push([[2633],{42633:(e,t,n)=>{n.d(t,{EG:()=>d,Ll:()=>w,R3:()=>$,UH:()=>u,aM:()=>p,fs:()=>m,i0:()=>T});var i=n(65256),o=n(53430),s=n(98976),r=(n(86300),n(36693)),a=n(67478);const u=",",l={years:365,months:30,days:1,hours:1/24,minutes:1/1440,seconds:1/86400,milliseconds:1/864e5},f=new Set(["integer","small-integer"]);let c=null;function m(e){return(0,o.vE)(e)||(0,o.zD)(e)||(0,o.Ah)(e)}async function d(e){const{field:t,field2:n,field3:i,normalizationField:o,valueExpression:r}=e;let a=[];if(r){if(!c){const{arcadeUtils:e}=await(0,s.lw)();c=e}a=c.extractFieldNames(r)}return t&&a.push(t),n&&a.push(n),i&&a.push(i),o&&a.push(o),a}function g(e){return String(e).padStart(2,"0")}function h(e,t,n){let i;return"date"===t||"number"===t?("number"===t&&(e=new Date(e)),i=`TIMESTAMP'${n?e.getFullYear():e.getUTCFullYear()}-${g((n?e.getMonth():e.getUTCMonth())+1)}-${g(n?e.getDate():e.getUTCDate())} ${g(n?e.getHours():e.getUTCHours())}:${g(n?e.getMinutes():e.getUTCMinutes())}:${g(n?e.getSeconds():e.getUTCSeconds())}'`):i=e,i}function p(e,t,n,i){const{hasQueryEngine:o}=e,s=`(${h(n,y(e,n),o)} - ${h(t,y(e,t),o)})`;let r=l[i],a="/";return r<1&&(r=1/r,a="*"),{sqlExpression:1===r?s:`(${s} ${a} ${r})`,sqlWhere:null}}function y(e,t){if(t instanceof Date)return"date";if("number"==typeof t)return"number";if("string"==typeof t){const n=e.getField(t);if("<now>"===t.toLowerCase())return;if((0,o.vE)(n))return"field"}}function $(e,t){const n=t&&e.getField(t);return!!n&&f.has(n.type)}function w(e){return`cast(${e} as float)`}function T(e,t){const{format:n,timeZoneOptions:o,fieldType:s}=t??{};let u,l;if(o&&({timeZone:u,timeZoneName:l}=(0,a.hv)(o.layerTimeZone,o.datesInUnknownTimezone,o.viewTimeZone,(0,i.J2)(n||"short-date-short-time"),s)),"string"==typeof e&&isNaN(Date.parse("time-only"===s?`1970-01-01T${e}Z`:e)))return e;switch(s){case"date-only":{const t=(0,i.J2)(n||"short-date");return"string"==typeof e?(0,i.iS)(e,{...t}):(0,i.Yq)(e,{...t,timeZone:r.n$})}case"time-only":{const t=(0,i.J2)(n||"short-time");return"string"==typeof e?(0,i.F8)(e,t):(0,i.Yq)(e,{...t,timeZone:r.n$})}case"timestamp-offset":{if(!u&&"string"==typeof e&&new Date(e).toISOString()!==e)return e;const t=n||o?(0,i.J2)(n||"short-date-short-time"):void 0,s=t?{...t,timeZone:u,timeZoneName:l}:void 0;return"string"==typeof e?(0,i.Ey)(e,s):(0,i.Yq)(e,s)}default:{const t=n||o?(0,i.J2)(n||"short-date-short-time"):void 0;return(0,i.Yq)("string"==typeof e?new Date(e):e,t?{...t,timeZone:u,timeZoneName:l}:void 0)}}}}}]);
//# sourceMappingURL=2633.11dd6cbe.chunk.js.map